---
layout: default
title:  "BRIX5 Modular Wearable Prototyping Toolkit"
excerpt: "Wearable Prototyping made easy with the interoperable BRIX5 toolkit (Ph.D. Thesis)"
featured-image: img/2020-BRIX5/cover.jpg
---

<h1>BRIX5 Modular Wearable Prototyping Toolkit</h1>
**Skills:** System Engineering, Wearable Design, Embedded Development (Arduino/Wiring), 3D-Printing, Project Management, PCB Design + Assembly

<span class="image left"><a class="gallery" href="img/2020-BRIX5/cover.jpg"><img src="img/2020-BRIX5/cover.jpg" alt="BRIX5 Symbol" /></a></span>

In over a decade of work as human-computer interaction (HCI) researcher, I have also become a toolmaker. Existing toolkits proved too limited. For example, when developing the [tilt'n'roll skateboard](/2010-solderin_skaters) back in 2010, we needed to attach additional analog sensors, but no wireless sensor boards where small enough AND supported general-purpose in-/output (GPIO). The custom controller I designed for the skateboard was quickly found to be valuable for wearable HCI research prototypes at the [Ambient Intelligence (AmI) Lab](https://www.cit-ec.de/ami). 

Sebastian Zehe's BRIX and [BRIX₂ system](https://techfak.de/ags/ami/BRIX₂), addressed the lab's needs for a versatile toolkit for prototyping and teaching physical computing, stationary and wearable. 
Housed in LEGO pieces, up to three extensions can be stacked on top of a base module with twin ATMega microcontrollers, motion sensor, battery and RF interface.
The initial haptic [shoe](/2015-Shoes) and [belt](/2014-2021-Belt) prototypes were both built using BRIX₂, but as a power user, I quickly hit limitations of the system, most notably the limit of three extensions, the difficulty of integrating the LEGO bricks into a wearable, and of producing and connecting custom extensions through the high-density connector.

It became apparent that BRIX₂'s LEGO housing, though both a good mechanical interconnect and metaphor, limited extension and wearable integration.
While it reduced wire clutter when proper extensions were used, the fine-pitch module interconnect was impractical for hand-soldering.
Only three extensions (e.g., only three audio extensions) could be connected.
Existing off-the-shelf breakout boards or custom modules could not be connected easily or robustly, and creating custom BRIX₂ extensions required substantial development and maintenance work, which eventually hindered adaption of emerging technology.

The BRIX5 system solves these issues and is based on two standards that have since emerged: Qwiic, and Feather.
It implements the idea of a base controller that enables quick wearable prototyping, and provides extensions for vibrotactile haptics.
BRIX5 provided the basis for the recent [belt](/2014-2021-Belt) and [NeuroCommTrainer](/2017-2020-NeuroComm-Trainer) prototypes, and was developed in collaboration with Sebastian Zehe (hardware design and assembly) at the AmI Lab.

<br/>

<h2>Qwiic and Feather Compatible</h2>
<div class="box alt">
	<div class="row uniform">
		<div class="7u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/brix5-featherbase-assembled.jpg"><img src="img/2020-BRIX5/brix5-featherbase-assembled.jpg" alt="brix5-featherbase-assembled" /></a></span></div>
		<div class="5u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/explosion_small.jpg"><img src="img/2020-BRIX5/explosion_small.jpg" alt="BRIX5 explosion" /></a></span></div>
	</div>
</div>

The [Sparkfun Qwiic](https://www.sparkfun.com/qwiic) standard specifies an I2C-based interconnect for daisy-chaining breakout boards and has rapidly become a widely adopted standard.
Conversely, the [Adafruit Feather](https://learn.adafruit.com/adafruit-feather/feather-specification) specification describes a breakout board for microcontroller base breakouts (with power supply circuitry).
BRIX5 extends a Feather base controller

BRIX5 is built around the open Feather and Qwiic interconnect systems, allowing it to support a wide range of open prototyping platforms ranging from low-power microcontrollers to full-featured single board computers.
Our goal was to minimize custom PCB development and reinventing the wheel, to maximize flexibility, facilitate reproduction, and not locking users into one specific architecture. %, adaptation, and repair.
This is in contrast to BRIX₂ and most other research-based toolkits.
We chose the version number five to acknowledge this major change in design and intention. 
		
The BRIX5 base controller provides common needs of wearable prototypes, similar to the BRIX₂ base module.
In contrast to off-the-shelf wearables, such as the Pebble or the Mii-Band, it is designed for user modification and extension.
In contrast to, e.g., the BRIX₂ base module, it is not monolithic, but rather a combination of a Adafruit Feather and a custom PCB augmenting it with Qwiic extension interconnect, basic in-/output, motion sensor, real-time clock, and switchable power supply.
Our design prioritizes an increase in flexibility and reduced maintenance over the highest-possible integration on a monolithic custom system.
Basing our system on the Feather-family of development boards means outsourcing the most time-consuming parts of design, allowing the system to grow with an existing ecosystem, and connecting users with a large existing user base.
			
The Feather stacks onto our base PCB with double-length pinheaders, preserving the ability to extend the system with Feather wings.
Feathers originally did not support Qwiic, and our base module provides four Qwiic ports, bridging between these two prototyping standards to provide enormous choice of pre-existing extensions.
A complete base module is shown exploded in above and extends a Feather of choice with:

* **Two RGB LEDs** for indicators, WS2811-compatible
* **Button** for user input 
* **9-DoF motion sensor** (Bosch BNO080)
* **LRA tactor** and driver
* **Real-Time Clock (RTC)**, to timestamp sensor data
* **Power:** switchable 450 mAh lithium polymer battery
* **4 Qwiic ports** with \textbf{I2C bus power reset} to recover from bus hangups
 
Qwiic cables up to 500 mm are readily and cheaply available (< 3\$) and can easily be extended with coiled or shielded wire if the application requires more robustness or length, for very long cables I2C-over-RJ485 and I2C-reconditioning modules are available.
			
<h2>State-of-the-Art Vibrotactile Support</h2>

<h3>Embedded Synthesis and HD Haptics Tactors</h3>
<div class="box alt">
	<div class="row uniform">
		<div class="6u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/lofelt-packaged-open-withref-side-small.jpg"><img src="img/2020-BRIX5/lofelt-packaged-open-withref-side-small.jpg" alt="2020-BRIX5/lofelt-packaged-open-withref-side-small.jpg" /></a></span></div>
		<div class="6u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/audio_power_belt-draft-crop.jpg"><img src="img/2020-BRIX5/audio_power_belt-draft-crop.jpg" alt="audio_power_belt" /></a></span></div>
	</div>
</div>

The Audio-400 extension, shown in above, is based on a Teensy-DAC architecture that provides 4-channel embedded audio/haptic synthesis and can both operate stand-alone, e.g., in a belt or as part of a larger system, such as [NeuroCommTrainer](/2017-2020-NeuroComm-Trainer) system.

As actuators, we primarily support Lofelt L5 tactors housed together with a highly integrated amplifier module.
The modules also connect through Qwiic cables, thus requiring only one type of cable for all interconnects in the BRIX5 system.

<h3>Audio-Connnectors</h3>
<div class="box alt">
	<div class="row uniform">
		<div class="6u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/ac-setup.jpg"><img src="img/2020-BRIX5/ac-setup.jpg" alt="ac-setup" /></a></span></div>
		<div class="3u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/acs-100-rj45-sh-stack.jpg"><img src="img/2020-BRIX5/acs-100-rj45-sh-stack.jpg" alt="2020-BRIX5/acs-100-rj45-sh-stack.jpg" /></a></span></div>
		<div class="3u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/acl-100-cables.jpg"><img src="img/2020-BRIX5/acl-100-cables.jpg" alt="acl-100-cables" /></a></span></div>
	</div>
</div>
Audio adapter boards route four channels of audio/haptic signals through off-the-shelf RJ45 ethernet cabling and allow to switch quickly between tethered (external signal source) and untethered operation.

<h3>Quad-Channel ERM/LRA Control</h3>
<div class="box alt">
	<div class="row uniform">
		<div class="6u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/qwiic_quaddrv-bot_side.jpg"><img src="img/2020-BRIX5/qwiic_quaddrv-bot_side.jpg" alt="2020-BRIX5/qwiic_quaddrv-bot_side.jpg" /></a></span></div>
		<div class="6u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/lra-packaged-withref.jpg"><img src="img/2020-BRIX5/lra-packaged-withref.jpg" alt="lra-packaged-withref" /></a></span></div>
	</div>
</div>
The overwhelming majority of VT wearables use ERMs, either operating at a fixed rotation speed or controlling it through pulse-width modulation in an open-loop fashion, which results in slow ramp-up and ramp-down of vibration intensity.
The QuadDRV module drives four ERMs or LRAs, and is built around four TI DRV2605L haptic driver arbitrated by an I2C multiplexer. 
For ERMs, it provides closed-loop control with active braking and overdrive, which improves ERM response to the point of pulse sharpness similar to voice coils. 
For LRAs, it provides automatic resonance tuning necessary to derive optimal output amplitude, as resonance frequency varies between tactor samples and with integration.
Given appropriate power supply, up to 16 QuadDRV modules can be connected that would provide 64-channels of low-fidelity VT haptics.
The tactors are connected through a 8-pin Molex Picoblade (1.25 mm pitch) plug, chosen for its compact size and the availability of pre-made cables by the manufacturer.
An example LRA tactor is shown above, and an application of QuadDRV modules is the [NeuroCommTrainer](/2017-2020-NeuroComm-Trainer) glove. 


<h2>Best-in-class Motion Sensors</h2>
<div class="box alt">
	<div class="row uniform">
		<div class="5u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/bno-strap-2-open.jpg"><img src="img/2020-BRIX5/bno-strap-2-open.jpg" alt="2020-BRIX5/bno-strap-2-open.jpg" /></a></span></div>
		<div class="7u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/bno-both.jpg"><img src="img/2020-BRIX5/bno-both.jpg" alt="2020-BRIX5/bno-both.jpg" /></a></span></div>
	</div>
</div>
Many wearable applications require a motion/orientation sensor, e.g., in the wearabelt case to determine trunk tilt.
Over the course of the project, we worked with various low-cost sensors, and settled on the Bosch Sensortec BNO080, a 9-DOF MARG (Magnetic, Angular Rate, and Gravity) sensor that provides raw and filtered sensor data as well as internally fused orientation.
Its orientation output at up to 400 Hz is configurable and, in our experience, exhibits less drift than the predecessor model BNO055, the MPU-9150 used in BRIX₂, and the Magdwick algorithm in combination with an NXP BRKT-STBC-AGM04 breakout board.

The base module includes one Bosch BNO080, for applications requiring additional sensors we provide miniaturized BNO050/080 extensions in two sizes, miniBNO and microBNO.
The mini-size is suitable for strap-mounting and exposes more chip configuration options, the micro-size is roughly the size of a fingernail and meant ito be integrated into garments, e.g., glove fingertips, or attached to the body directly with with adhesive tape..

<!--
<div class="box alt">
	<div class="row uniform">
		<div class="6u"><span class="image fit"><a class="gallery" href="img/"><img src="img/" alt="" /></a></span></div>
		<div class="6u"><span class="image fit"><a class="gallery" href="img/"><img src="img/" alt="" /></a></span></div>
	</div>
</div>
-->
