---
layout: default
title:  "BRIX5 Modular Wearable Prototyping Toolkit"
excerpt: "Wearable Prototyping made easy with the interoperable BRIX5 toolkit (Ph.D. Thesis)"
featured-image: img/2020-BRIX5/cover.jpg
---

<h1>BRIX5 Modular Wearable Prototyping Toolkit</h1>
<span class="image left"><a class="gallery" href="img/2020-BRIX5/cover.jpg"><img src="img/2020-BRIX5/cover.jpg" alt="BRIX5 Symbol" /></a></span>

In over a decade of work as human-computer interaction (HCI) researcher, I have also become a toolmaker. Existing toolkits proved too limited. For example, when developing the [tilt'n'roll skateboard](/2010-solderin_skaters) back in 2010, we needed to attach additional analog sensors, but no wireless sensor boards where small enough AND supported general-purpose in-/output (GPIO). The custom controller I designed for the skateboard was quickly found to be valuable for wearable HCI research prototypes at the [Ambient Intelligence (AmI) Lab](https://www.cit-ec.de/ami). 

Sebastian Zehe's BRIX and [BRIX2 system](https://techfak.de/ags/ami/brix2), addressed the lab's needs for a versatile toolkit for prototyping and teaching physical computing, stationary and wearable. 
Housed in LEGO pieces, up to three extensions can be stacked on top of a base module with twin ATMega microcontrollers, motion sensor, battery and RF interface.
The initial haptic [shoe](/2015-Shoes) and [belt](/2014-2021-Belt) prototypes were both built using BRIX2, but as a power user, I quickly hit limitations of the system, most notably the limit of three extensions, the difficulty of integrating the LEGO bricks into a wearable, and of producing and connecting custom extensions through the high-density connector.
<!--
It became apparent that \brixtwoc's LEGO housing, though both a good mechanical interconnect and metaphor, limited extension and wearable integration.
While it reduced wire clutter when proper extensions were used, the fine-pitch module interconnect was impractical for hand-soldering.
Only three extensions (e.g., only three audio extensions) could be connected.
Existing off-the-shelf breakout boards or custom modules could not be connected easily or robustly, and creating custom \brixtwo extensions required substantial development and maintenance work, which eventually hindered adaption of emerging technology.
-->

The BRIX5 system solves these issues and is based on two standards that have since emerged: Qwiic, and Feather.
It implements the idea of a base controller that enables quick wearable prototyping, and provides extensions for vibrotactile haptics.


Skills: Systems Engineering, Wearable Design, PCB Design + Manufacturing, Embedded Development (Arduino/Wiring), 3D-Printing

<br/>

<h2>Qwiic and Feather Compatible</h2>
<div class="box alt">
	<div class="row uniform">
		<div class="7u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/brix5-featherbase-assembled.jpg"><img src="img/2020-BRIX5/brix5-featherbase-assembled.jpg" alt="brix5-featherbase-assembled" /></a></span></div>
		<div class="5u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/explosion_small.jpg"><img src="img/2020-BRIX5/explosion_small.jpg" alt="BRIX5 explosion" /></a></span></div>
	</div>
</div>

The [Sparkfun Qwiic](https://www.sparkfun.com/qwiic) standard specifies an I2C-based interconnect for daisy-chaining breakout boards and has rapidly become a widely adopted standard.
Conversely, the [Adafruit Feather](https://learn.adafruit.com/adafruit-feather/feather-specification) specification describes a breakout board for microcontroller base breakouts (with power supply circuitry).
BRIX5 extends a Feather base controller

<!--
		BRIX5 is built around the open Feather and Qwiic interconnect systems, allowing it to support the wide range of open prototyping platforms ranging from low-power microcontrollers to full-featured single board computers described in \secref{sec:rw_prototyping}.
		Our goal was to minimize custom PCB development and reinventing the wheel, to maximize flexibility, facilitate reproduction, and not locking users into one specific architecture. %, adaptation, and repair.
		This is in contrast to \brixtwo and most other research-based toolkits.
		We chose the version number five to acknowledge this major change in design and intention. 
		The BRIX5 base controller provides common needs of wearable prototypes, similar to the \brixtwo base module.
		In contrast to off-the-shelf wearables, such as the Pebble or the Mii-Band~\cite{Blum2019}, it is designed for user modification and extension.
		In contrast to, e.g., the \brixtwo base module, it is not monolithic, but rather a combination of a Adafruit Feather and a custom PCB augmenting it with Qwiic extension interconnect, basic in-/output, motion sensor, real-time clock, and switchable power supply.
		Our design prioritizes an increase in flexibility and reduced maintenance over the highest-possible integration on a monolithic custom system.
			Basing our system on the Feather-family of development boards means outsourcing the most time-consuming parts of design, allowing the system to grow with an existing ecosystem, and connecting users with a large existing user base.
			
			The Feather stacks onto our base PCB with double-length pinheaders, preserving the ability to extend the system with Feather wings.
			A complete base module is shown exploded in \figref{fig:brix5_explosion} and extends a Feather of choice with:

			\begin{itemize}
				\item \textbf{Two RGB LEDs} for indicators\footnote{addressable, WS2811-compatible\todo{SZ:?}}
				\item \textbf{Button} for user input 
				\item \textbf{9-DoF motion sensor},\footnote{Bosch BNO080} also see \secref{sec:bno}
				\item \textbf{LRA tactor} and driver,\footnote{TI DRV2605, Jin Long Machines LVM061530B} also see \secref{sec:quaddrv}
				\item \textbf{Real-Time Clock (RTC)}\footnote{Micro Crystal RV1805, to timestamp sensor data or synchronization between multiple units~\cite{Blum2019}}
					% link to jeff paper for why an rtc is necessary for exactly timed distributed haptics?
				\item \textbf{Power:} switchable 450 mAh lithium polymer battery
				qwiic w bus reset
					%TODO \footnote{\todo{run time?}}
			\end{itemize}
			
				%\item \textbf{Extension:} 4 Qwiic ports, with \textbf{I2C bus power reset} to recover from bus hangups
			We tested base modules based on the nRF52 and ESP32 microcontroller feathers, others should work similarly.
			Feathers originally did not support Qwiic, and our base module provides four Qwiic ports, bridging between these two prototyping standards to provide enormous choice of pre-existing extensions.
			Qwiic cables up to 500 mm are readily and cheaply available (< 3\$) and can easily be extended with coiled or shielded wire if the application requires more robustness or length, for very long cables \iicc-over-RJ485 and \iicc-reconditioning modules are available.
			-->
			
<h2>State-of-the-Art Vibrotactile Support</h2>

<h3>Embedded Synthesis and HD Haptics Tactors</h3>
<div class="box alt">
	<div class="row uniform">
		<div class="6u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/lofelt-packaged-open-withref-side-small.jpg"><img src="img/2020-BRIX5/lofelt-packaged-open-withref-side-small.jpg" alt="2020-BRIX5/lofelt-packaged-open-withref-side-small.jpg" /></a></span></div>
		<div class="6u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/audio_power_belt-draft-crop.jpg"><img src="img/2020-BRIX5/audio_power_belt-draft-crop.jpg" alt="audio_power_belt" /></a></span></div>
	</div>
</div>

			The Audio-400 extension, shown in \figref{fig:audio-400} (1), is a re-design of the Teensy-DAC architecture described in \secref{sec:beltmkII} for Qwiic operation.
			It provides 4-channel embedded audio/haptic synthesis and can both operate stand-alone, e.g., in a belt or as part of a larger system, such as described in \secref{sec:gameboy}

			The Amp-200 module has more than twice the power of the previous amplifiers (up to 3.3 W output power) and can be integrated neatly with Lofelt L5 tactor modules, shown in \figref{fig:brix5_tactor_open} and \figref{fig:audio-400} (4).
			The Amp-200 module is a compact and powerful D-Class amplifier (up to 3.3 W output power) that can be integrated neatly with Lofelt L5 tactor modules, shown in \figref{fig:brix5_tactor_open} and \figref{fig:audio-400} (4).

			The two modules connect through Qwiic cables, thus requiring only one type of cable for all interconnects in the BRIX5 system.
<h3>Audio-Connnectors</h3>
<div class="box alt">
	<div class="row uniform">
		<div class="6u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/ac-setup.jpg"><img src="img/2020-BRIX5/ac-setup.jpg" alt="ac-setup" /></a></span></div>
		<div class="3u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/acs-100-rj45-sh-stack.jpg"><img src="img/2020-BRIX5/acs-100-rj45-sh-stack.jpg" alt="2020-BRIX5/acs-100-rj45-sh-stack.jpg" /></a></span></div>
		<div class="3u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/acl-100-cables.jpg"><img src="img/2020-BRIX5/acl-100-cables.jpg" alt="acl-100-cables" /></a></span></div>
	</div>
</div>
			Audio adapter boards, similar to those described in \secref{sec:beltmkII}, route four channels of audio/haptic signals through off-the-shelf RJ45 ethernet cabling and allow to switch quickly between tethered (external signal source) and untethered operation.

<h3>Quad-Channel ERM/LRA Control</h3>
<div class="box alt">
	<div class="row uniform">
		<div class="6u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/qwiic_quaddrv-bot_side.jpg"><img src="img/2020-BRIX5/qwiic_quaddrv-bot_side.jpg" alt="2020-BRIX5/qwiic_quaddrv-bot_side.jpg" /></a></span></div>
		<div class="6u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/lra-packaged-withref.jpg"><img src="img/2020-BRIX5/lra-packaged-withref.jpg" alt="lra-packaged-withref" /></a></span></div>
	</div>
</div>
			The overwhelming majority of VT wearables use ERMs, either operating at a fixed rotation speed or controlling it through pulse-width modulation~\cite{Thar2017b} in an open-loop fashion, which results in slow ramp-up and ramp-down of vibration intensity.
			The QuadDRV module drives four ERMs or LRAs, and is built around four TI DRV2605L haptic driver arbitrated by an I2C multiplexer. 
			For ERMs, it provides closed-loop control with active braking and overdrive, which improves ERM response to the point of pulse sharpness~\cite{Barsilai2014a} similar to voice coils. 
			For LRAs, it provides automatic resonance tuning necessary to derive optimal output amplitude, as resonance frequency varies between tactor samples and with integration.
			Given appropriate power supply, up to 16 QuadDRV modules can be connected that would provide 64-channels of low-fidelity VT haptics.
			The tactors are connected through a 8-pin Molex Picoblade (1.25 mm pitch) plug, chosen for its compact size and the availability of pre-made cables by the manufacturer.
			An example LRA tactor is shown in \figref{fig:brix5_lra}, and an application of QuadDRV modules is described in \secref{sec:nct-glove}.


<h2>Best-in-class Motion Sensors</h2>
<div class="box alt">
	<div class="row uniform">
		<div class="5u"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/bno-strap-2-open.jpg"><img src="img/2020-BRIX5/bno-strap-2-open.jpg" alt="2020-BRIX5/bno-strap-2-open.jpg" /></a></span></div>
		<div class="7u$"><span class="image fit"><a class="gallery" href="img/2020-BRIX5/bno-both.jpg"><img src="img/2020-BRIX5/bno-both.jpg" alt="2020-BRIX5/bno-both.jpg" /></a></span></div>
	</div>
</div>
			Many wearable applications require a motion/orientation sensor, e.g., in the wearabelt case to determine trunk tilt.
			Over the course of the project, we worked with various low-cost sensors, and settled on the Bosch Sensortec BNO080, a 9-DOF MARG (Magnetic, Angular Rate, and Gravity) sensor that provides raw and filtered sensor data as well as internally fused orientation.
			Its orientation output at up to 400 Hz is configurable and, in our experience, exhibits less drift than the predecessor model BNO055, the MPU-9150 used in \brixtwoc, and the Magdwick algorithm~\cite{Madgwick2011} in combination with an NXP BRKT-STBC-AGM04 breakout board; Lin et al. report similar performance~\cite{Lin2017}.

			The base module includes one Bosch BNO080, for applications requiring additional sensors we provide miniaturized BNO050/080 extensions in two sizes, miniBNO and microBNO (\figref{fig:nct_montage}, right box, left bottom).\footnote{Our PCB design accommodates both BNO055 and BNO080.}
			The mini-size is suitable for strap-mounting and exposes more chip configuration options, the micro-size is roughly the size of a fingernail and meant ito be integrated into garments, e.g., glove fingertips, or attached to the body directly with with adhesive tape. %, as described in \secref{sec:nct-glove}.
<!--
<div class="box alt">
	<div class="row uniform">
		<div class="6u"><span class="image fit"><a class="gallery" href="img/"><img src="img/" alt="" /></a></span></div>
		<div class="6u"><span class="image fit"><a class="gallery" href="img/"><img src="img/" alt="" /></a></span></div>
	</div>
</div>
-->
